<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/dracula.css">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@200&display=swap" rel="stylesheet">

<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>8 - Magic Numbers</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <header>
        <h1>Magic Numbers</h1>
    </header>
    <main class="two-column">
        <section>
            Magic Numbers zijn waarden die op zich zelf geen context of intentie
            verschaffen.<br>
            <pre>If (id == -1) {} else if (id == 0)</pre> bijvoorbeeld. Zonder eerst op zoek te gaan naar wat -1 of 0
            mogelijk zou kunnen zijn en waarom dit is ben je even verder.<br>
            Vervang je 0 door een
            <pre>const int NewRecord</pre> en -1 door
            <pre>const int NullValue</pre> dan is de intentie direct duidelijk.<br>
            Magic Numbers zijn niet beperkt tot numbers, ook strings vallen hieronder. Bijvoorbeeld "new" of "record" of wat dan ook. Op zich zelf kun je bij "new" a
        </section>
    </main>
    <main class="two-column">
        <section class="fifty">
            Voorkom Magic Numbers (of strings) door een van de volgende technieken te gebruiken:
            <ul>
                <li><b>Named Constant</b> <pre>const int AmDossierEindRapport = 42</pre></li>
                <li><b>Named Constant</b> <pre>const string Meneer = "Meneer"</pre></li>
                <li><b>Enum</b> <pre>enum DossierStatus { New, InProgress, Done }</pre></li>
                <li><b>Class</b> <pre>class DossierStatus { <br/>public const int New = 0; public const int InProgress = 1; public const int Done = 2; }</pre></li>
                <li><b>Comment</b> En als je echt een magic number/string wil gebruiken voeg dan commentaar toe.</li>
            </ul>
        </section>
        <section class="fifty">
            <blockquote>
                Any constant, other than 0 or 1, that appears in your program is a magic number. 
                <br/>~ Michael Feathers, author of "Working Effectively with Legacy Code".
            </blockquote>
        </section>
    </main>
    <main class="two-column">
        <section class="fifty">
            <pre><code class="csharp">
namespace CleanCode;
public class MagicNumbers
{
    private IService someService;
    
    public Double SomeCalcAction(int id)
    {
        try
        {
            var input = PrepCalculation()
            return someService.RunCalcuation();
        }
        // (1) Dit is een "Catch All" die alle Exceptions afhandeld.
        catch(Exception ex)
        {
            // (2) ignore
        }
        return Double.NaN;
    }

    private Double PrepCalculation(int id)
    {
        var result = someService.LoadCalc(id);
        if (result is null)
        {
            // (3) Gooi fout door naar aanroeper ipv hier een afhandeling te maken.
            throw new Exception("Null from service");
        }
        return result;
    }
}
        </code></pre>
        </section>
        <section class="fifty">
            <pre><code class="csharp">
namespace CleanCode;
public class ExceptionHandling
{
    private IService someService;

    public Double? SomeCalcAction(int id)
    {
        try
        {
            var input = PrepCalculation()
            if (input is null)
                return null;

            return someService.RunCalcuation();
        }
        // (2) Handel fouten of als die verwacht worden. In het dotnet framework wordt dit vaak in de documentatie gemeld welke er te verwachten zijn.
        //   Bijvoorbeeld Decimal.ToString geeft mogelijk een FormatException terug 
        //   https://learn.microsoft.com/en-us/dotnet/api/system.decimal.tostring?view=net-7.0#system-decimal-tostring(system-string-system-iformatprovider)
        catch(ArithmeticException ex)
        {
            // (3)
            logger.LogError(ex);
        }
        //-> Handel geen globale exception af als je er niks mee doet. Daar zijn UnhandledExceptionHandlers voor.
        finally()
        {
            // (2) Zorg voor een nette afhandeling (als dit kan)
            return Double.NaN;
        }
    }
    
    private Double? PrepCalculation(int id)
    {
        var result = someService.LoadCalc(id);
        if (result is null)
        {
            // (3) log unexpected result?
        }
        return result;
    }
}
                
                </code></pre>
        </section>
    </main>
    <footer>
        <h2>Referenties</h2>
        <ul>
            <li>
                <a
                    href="https://learn.microsoft.com/en-us/dotnet/csharp/fundamentals/exceptions/exception-handling">learn.microsoft.com</a>
                Exception Handling (C# Programming Guide)
            </li>
        </ul>
    </footer>
</body>

</html>
<script>hljs.highlightAll();</script>